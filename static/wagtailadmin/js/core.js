function addMessage(status,text){$('.messages').addClass('new').empty().append('<ul><li class="'+ status+'">'+ text+'</li></ul>');var addMsgTimeout=setTimeout(function(){$('.messages').addClass('appear');clearTimeout(addMsgTimeout);},100);}
function escapeHtml(text){var map={'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;','\'':'&#039;'};return text.replace(/[&<>"']/g,function(m){return map[m];});}
function initTagField(id,autocompleteUrl){$('#'+ id).tagit({autocomplete:{source:autocompleteUrl},preprocessTag:function(val){if(val&&val[0]!='"'&&val.indexOf(' ')>-1){return'"'+ val+'"';}
return val;}});}
$(function(){$('body').addClass('ready');$(document).on('click','#nav-toggle',function(){$('body').toggleClass('nav-open');if(!$('body').hasClass('nav-open')){$('body').addClass('nav-closed');}else{$('body').removeClass('nav-closed');}});var fitNav=function(){$('.nav-wrapper').css('min-height',$(window).height());$('.nav-main').each(function(){var thisHeight=$(this).height();var footerHeight=$('.footer',$(this)).height();});};fitNav();$(window).resize(function(){fitNav();});$(document).on('focus mouseover','input,textarea,select',function(){$(this).closest('.field').addClass('focused');$(this).closest('fieldset').addClass('focused');$(this).closest('li').addClass('focused');});$(document).on('blur mouseout','input,textarea,select',function(){$(this).closest('.field').removeClass('focused');$(this).closest('fieldset').removeClass('focused');$(this).closest('li').removeClass('focused');});$(document).on('click','.tab-nav a',function(e){e.preventDefault();$(this).tab('show');});$(document).on('click','.tab-toggle',function(e){e.preventDefault();$('.tab-nav a[href="'+ $(this).attr('href')+'"]').click();});$('.dropdown-toggle').bind('click',function(){$(this).closest('.dropdown').toggleClass('open');return false;});$(document).on('click',function(e){var relTarg=e.relatedTarget||e.toElement;if(!$(relTarg).hasClass('dropdown-toggle')){$('.dropdown').removeClass('open');}});$('.drop-zone').on('dragover',function(){$(this).addClass('hovered');}).on('dragleave dragend drop',function(){$(this).removeClass('hovered');});if(window.headerSearch){var searchCurrentIndex=0;var searchNextIndex=0;$(window.headerSearch.termInput).on('input',function(){clearTimeout($.data(this,'timer'));var wait=setTimeout(search,200);$(this).data('timer',wait);});$(window.headerSearch.termInput).trigger('focus');function search(){var workingClasses='icon-spinner';$(window.headerSearch.termInput).parent().addClass(workingClasses);searchNextIndex++;var index=searchNextIndex;$.ajax({url:window.headerSearch.url,data:{q:$(window.headerSearch.termInput).val()},success:function(data,status){if(index>searchCurrentIndex){searchCurrentIndex=index;$(window.headerSearch.targetOutput).html(data).slideDown(800);window.history.pushState(null,'Search results','?q='+ $(window.headerSearch.termInput).val());}},complete:function(){$(window.headerSearch.termInput).parent().removeClass(workingClasses);}});}}
$(document).on('shown.bs.tab',function(e){$('textarea[data-autosize-on]').each(function(){autosize.update($(this).get());});});$(document).on('click','button.button-longrunning',function(e){var $self=$(this);var $replacementElem=$('em',$self);var reEnableAfter=30;var dataName='disabledtimeout'
var timeout=setTimeout(function(){if(!$self.data(dataName)){$self.data(dataName,setTimeout(function(){clearTimeout($self.data(dataName));$self.prop('disabled','').removeData(dataName).removeClass('button-longrunning-active')
if($self.data('clicked-text')){$replacementElem.text($self.data('original-text'));}},reEnableAfter*1000));if($self.data('clicked-text')&&$replacementElem.length){$self.data('original-text',$replacementElem.text());$replacementElem.text($self.data('clicked-text'));}
$self.addClass('button-longrunning-active').prop('disabled','true');}
clearTimeout(timeout);},10);});});